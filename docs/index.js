class t{constructor(){this.children=new Map,this.isEnd=!1}getFirstBranch(){return function(e){let t="";for(;!e.isEnd;){const n=e.children.keys().next().value;t+=n,e=e.children.get(n)}return t}(this)}getSuffixes(){const e=[];return function t(n,s){n.isEnd&&e.push(s);for(const[e,o]of n.children.entries())t(o,s+e)}(this,""),e}}class e{constructor(){this.root=new t}set(e){let n=this.root;for(let s=0;s<e.length;s++){const o=e[s];n.children.has(o)||n.children.set(o,new t),n=n.children.get(o)}n.isEnd=!0}get(e){let t=this.root;for(let n=0;n<e.length;n++){const s=e[n];if(!t.children.has(s))return null;t=t.children.get(s)}return t}}class i{get inputedHiragana(){let e="";for(let t=0;t<this.laticeIndex;t++)e+=this.latice[t].hiragana;if(e.endsWith("ã£")){const t=this.inputedRomaji.match(i.hatsuonRegexp)[0].length;e=e.replace(i.hatsuonRegexp,"ã£".repeat(t-1))}return e}get remainedRomaji(){const e=this.currentNode;return(e?e.getFirstBranch():"")+this.latice.slice(this.laticeIndex+1).map(e=>e.root.getFirstBranch()).join("")}get remainedHiragana(){return this.hiragana.slice(this.inputedHiragana.length)}constructor(e,t={}){this.hiragana=e,this.options=t||{},this.options.shortSokuon=t.shortSokuon??!0,this.options.shortHatsuon=t.shortHatsuon??!0,this.latice=this.toLatice(e),this.laticeIndex=0,this.currentNode=this.latice[0].root,this.inputedRomaji=""}toLatice(e){const t=[];return e.match(i.wordRegexp).forEach(e=>{if(e.match(i.hiraganaRegexp)){const n=this.toHiraganaLatice(e);t.push(...n)}else{const n=this.toAsciiLatice(e);t.push(...n)}}),t}toAsciiLatice(t){const n=[];return Array.from(t).forEach(t=>{const s=new e;s.set(t),n.push(s)}),n}toHiraganaLatice(t){const n=[],s=t.match(i.segmentRegexp);for(const t of s){const o=t.lastIndexOf("ã£");if(t.length>1&&o>=0){const s=t.slice(o+1);if(this.options.shortSokuon&&s.length>0){const t=new e;t.hiragana=s,this.getRomajiPattern(s).forEach(e=>{t.set(e)});const a=Array.from(t.root.children.keys());for(let r=0;r<=o;r++){const t=new e;t.hiragana="ã£",s[0].match(i.nagyoRegexp)||a.forEach(e=>{t.set(e)}),this.getRomajiPattern("ã£").forEach(e=>{t.set(e)}),n.push(t)}n.push(t)}else for(let s=0;s<=o;s++){const t=new e;t.hiragana="ã£",this.getRomajiPattern("ã£").forEach(e=>{t.set(e)}),n.push(t)}}else{const s=new e;s.hiragana=t,this.getRomajiPattern(t).forEach(e=>{s.set(e)}),n.push(s)}}return n}input(e){if(!this.currentNode)return!1;const t=this.currentNode.children.get(e);if(t)return t.isEnd?(this.laticeIndex+=1,this.laticeIndex>=this.latice.length?this.currentNode=null:this.currentNode=this.latice[this.laticeIndex].root):this.currentNode=t,this.inputedRomaji+=e,!0;switch(this.latice[this.laticeIndex].hiragana){case"ã‚“":{if(!this.options.shortHatsuon)return!1;if(!this.inputedRomaji.at(-1).match(/[xn]/))return!1;if(e.match(/[aiueoy]/))return!1;if(this.laticeIndex+1>=this.latice.length)return!1;const t=this.latice[this.laticeIndex+1].root.children.get(e);return!!t&&(this.laticeIndex+=1,this.currentNode=t,this.inputedRomaji+=e,!0)}case"ã£":{if(!this.options.shortSokuon)return!1;if(this.inputedRomaji.at(-1)!==e)return!1;if(e.match(/[aiueon]/))return!1;if(this.laticeIndex+1>=this.latice.length)return!1;const t=this.latice[this.laticeIndex+1].root.children.get(e);return!!t&&(this.laticeIndex+=1,this.currentNode=t,this.inputedRomaji+=e,!0)}}return!1}isEnd(){return!this.currentNode}getCombinations(e,t=[]){if(t.length===e.length)return[t.join("")];const n=[];for(const s of e[t.length])n.push(...this.getCombinations(e,[...t,s]));return n}get2gramPattern(e){const s=i.table[e[0]],n=i.table[e[1]],t=this.getCombinations([s,n]);if("ã£"===e[0]){if(i.nagyoRegexp.test(e[1]))return t;{const e=n.map(e=>e[0]+e);return e.push(...t),e}}{const n=i.table[e]||[];return n.push(...t),n}}get3gramPattern(e){const s=i.table[e[0]],o=i.table[e[1]],a=i.table[e[2]],t=i.table[e.slice(1)],n=t?this.getCombinations([s,t]):[],r=this.getCombinations([s,o,a]);if(i.nagyoRegexp.test(e[1]))return n.push(...r),n;{const e=t?t.map(e=>e[0]+e):[],s=o.map(e=>e[0]+e),i=this.getCombinations([s,a]);return e.push(...i),e.push(...n),e.push(...r),e}}getRomajiPattern(e){switch(e.length){case 1:return i.table[e];case 2:return this.get2gramPattern(e);case 3:return this.get3gramPattern(e);default:throw new Error("parse error")}}}Object.defineProperty(i,"wordRegexp",{enumerable:!0,configurable:!0,writable:!0,value:/([ã-ã‚–ãƒ¼]+|[ -~]+)/g}),Object.defineProperty(i,"hiraganaRegexp",{enumerable:!0,configurable:!0,writable:!0,value:/[ã-ã‚–ãƒ¼]+/g}),Object.defineProperty(i,"segmentRegexp",{enumerable:!0,configurable:!0,writable:!0,value:/ã£*[ã-ã‚–ãƒ¼][ããƒã…ã‡ã‰ã‚ƒã‚…ã‚‡]?/g}),Object.defineProperty(i,"nagyoRegexp",{enumerable:!0,configurable:!0,writable:!0,value:/[ãªã«ã¬ã­ã®ã‚“]/}),Object.defineProperty(i,"hatsuonRegexp",{enumerable:!0,configurable:!0,writable:!0,value:/(.)\1*$/}),Object.defineProperty(i,"table",{enumerable:!0,configurable:!0,writable:!0,value:{"ãƒ¼":["-"],"ã„ã‡":["ye"],"ã†ã":["wha"],"ã†ãƒ":["wi","whi"],"ã†ã‡":["we","whe"],"ã†ã‰":["who"],"ã‚”ã":["va"],"ã‚”ãƒ":["vi","vyi"],"ã‚”ã‡":["ve","vye"],"ã‚”ã‰":["vo"],"ã‚”ã‚ƒ":["vya"],"ã‚”ã‚…":["vyu"],"ã‚”ã‚‡":["vyo"],"ãã‚ƒ":["kya"],"ããƒ":["kyi"],"ãã‚…":["kyu"],"ãã‡":["kye"],"ãã‚‡":["kyo"],"ãã‚ƒ":["gya"],"ããƒ":["gyi"],"ãã‚…":["gyu"],"ãã‡":["gye"],"ãã‚‡":["gyo"],"ãã":["kwa","qa"],"ããƒ":["kwi","qi"],"ãã…":["kwu"],"ãã‡":["kwe","qe"],"ãã‰":["kwo","qo"],"ãã‚ƒ":["qya"],"ãã‚…":["qyu"],"ãã‚‡":["qyo"],"ãã":["gwa"],"ããƒ":["gwi"],"ãã…":["gwu"],"ãã‡":["gwe"],"ãã‰":["gwo"],"ã—ã‚ƒ":["sha","sya"],"ã—ãƒ":["syi"],"ã—ã‚…":["shu","syu"],"ã—ã‡":["she","sye"],"ã—ã‚‡":["sho","syo"],"ã˜ã‚ƒ":["ja","jya","zya"],"ã˜ãƒ":["jyi","zyi"],"ã˜ã‚…":["ju","jyu","zyu"],"ã˜ã‡":["je","jye","zye"],"ã˜ã‚‡":["jo","jyo","zyo"],"ã™ã":["swa"],"ã™ãƒ":["swi"],"ã™ã…":["swu"],"ã™ã‡":["swe"],"ã™ã‰":["swo"],"ã¡ã‚ƒ":["cha","cya","tya"],"ã¡ãƒ":["cyi","tyi"],"ã¡ã‚…":["chu","cyu","tyu"],"ã¡ã‡":["che","cye","tye"],"ã¡ã‚‡":["cho","cyo","tyo"],"ã¢ã‚ƒ":["dya"],"ã¢ãƒ":["dyi"],"ã¢ã‚…":["dyu"],"ã¢ã‡":["dye"],"ã¢ã‚‡":["dyo"],"ã¤ã":["tsa"],"ã¤ãƒ":["tsi"],"ã¤ã‡":["tse"],"ã¤ã‰":["tso"],"ã¦ã‚ƒ":["tha"],"ã¦ãƒ":["thi"],"ã¦ã‚…":["thu"],"ã¦ã‡":["the"],"ã¦ã‚‡":["tho"],"ã§ã‚ƒ":["dha"],"ã§ãƒ":["dhi"],"ã§ã‚…":["dhu"],"ã§ã‡":["dhe"],"ã§ã‚‡":["dho"],"ã¨ã":["twa"],"ã¨ãƒ":["twi"],"ã¨ã…":["twu"],"ã¨ã‡":["twe"],"ã¨ã‰":["two"],"ã©ã":["dwa"],"ã©ãƒ":["dwi"],"ã©ã…":["dwu"],"ã©ã‡":["dwe"],"ã©ã‰":["dwo"],"ã«ã‚ƒ":["nya"],"ã«ãƒ":["nyi"],"ã«ã‚…":["nyu"],"ã«ã‡":["nye"],"ã«ã‚‡":["nyo"],"ã²ã‚ƒ":["hya"],"ã²ãƒ":["hyi"],"ã²ã‚…":["hyu"],"ã²ã‡":["hye"],"ã²ã‚‡":["hyo"],"ã³ã‚ƒ":["bya"],"ã³ãƒ":["byi"],"ã³ã‚…":["byu"],"ã³ã‡":["bye"],"ã³ã‚‡":["byo"],"ã´ã‚ƒ":["pya"],"ã´ãƒ":["pyi"],"ã´ã‚…":["pyu"],"ã´ã‡":["pye"],"ã´ã‚‡":["pyo"],"ãµã":["fa","fwa","hwa"],"ãµãƒ":["fi","fwi","fyi","hwi"],"ãµã…":["fwu"],"ãµã‡":["fe","fwe","fye","hwe"],"ãµã‰":["fo","fwo","hwo"],"ãµã‚ƒ":["fya"],"ãµã‚…":["fyu"],"ãµã‚‡":["fyo"],"ã¿ã‚ƒ":["mya"],"ã¿ãƒ":["myi"],"ã¿ã‚…":["myu"],"ã¿ã‡":["mye"],"ã¿ã‚‡":["myo"],"ã‚Šã‚ƒ":["rya"],"ã‚Šãƒ":["ryi"],"ã‚Šã‚…":["ryu"],"ã‚Šã‡":["rye"],"ã‚Šã‚‡":["ryo"],"ã‚":["a"],"ã„":["i"],"ã†":["u","whu","wu"],"ãˆ":["e"],"ãŠ":["o"],"ã‹":["ka","ca"],"ã":["ki"],"ã":["ku","cu","qu"],"ã‘":["ke"],"ã“":["ko","co"],"ã•":["sa"],"ã—":["shi","si","ci"],"ã™":["su"],"ã›":["se","ce"],"ã":["so"],"ãŸ":["ta"],"ã¡":["chi","ti"],"ã¤":["tsu","tu"],"ã¦":["te"],"ã¨":["to"],"ãª":["na"],"ã«":["ni"],"ã¬":["nu"],"ã­":["ne"],"ã®":["no"],"ã¯":["ha"],"ã²":["hi"],"ãµ":["fu","hu"],"ã¸":["he"],"ã»":["ho"],"ã¾":["ma"],"ã¿":["mi"],"ã‚€":["mu"],"ã‚":["me"],"ã‚‚":["mo"],"ã‚„":["ya"],"ã‚†":["yu"],"ã‚ˆ":["yo"],"ã‚‰":["ra"],"ã‚Š":["ri"],"ã‚‹":["ru"],"ã‚Œ":["re"],"ã‚":["ro"],"ã‚":["wa"],"ã‚’":["wo"],"ã‚“":["nn","xn"],"ã":["xa","la"],"ãƒ":["xi","li","xyi","lyi"],"ã…":["xu","lu"],"ã‡":["xe","le","xye","lye"],"ã‰":["xo","lo"],"ã‚ƒ":["xya","lya"],"ã‚…":["xyu","lyu"],"ã‚‡":["xyo","lyo"],"ã‚•":["xka","lka"],"ã‚–":["xke","lke"],"ã£":["xtu","xtsu","ltu","ltsu"],"ã‚":["xwa","lwa"],"ãŒ":["ga"],"ã":["gi"],"ã":["gu"],"ã’":["ge"],"ã”":["go"],"ã–":["za"],"ã˜":["ji","zi"],"ãš":["zu"],"ãœ":["ze"],"ã":["zo"],"ã ":["da"],"ã¢":["di"],"ã¥":["du"],"ã§":["de"],"ã©":["do"],"ã°":["ba"],"ã³":["bi"],"ã¶":["bu"],"ã¹":["be"],"ã¼":["bo"],"ã±":["pa"],"ã´":["pi"],"ã·":["pu"],"ãº":["pe"],"ã½":["po"],"ã‚":["wyi"],"ã‚‘":["wye"],"ã‚”":["vu"]}});const gamePanel=document.getElementById("gamePanel"),infoPanel=document.getElementById("infoPanel"),countPanel=document.getElementById("countPanel"),scorePanel=document.getElementById("scorePanel"),startButton=document.getElementById("startButton"),romaNode=document.getElementById("roma"),japanese=document.getElementById("japanese"),gameTime=300;let playing,countdowning,typeTimer;const bgm=new Audio("mp3/bgm.mp3");bgm.volume=.3,bgm.loop=!0;let errorCount=0,normalCount=0,solveCount=0,problems=[],problem,guide=!1;const layout104={default:["q w e r t y u i o p","a s d f g h j k l ;","z x c v b n m , .","ğŸŒ {altLeft} {space} {altRight}"],shift:["Q W E R T Y U I O P","A S D F G H J K L :","Z X C V B N M < >","ğŸŒ {altLeft} {space} {altRight}"]},layout109={default:["q w e r t y u i o p","a s d f g h j k l ;","z x c v b n m , .","ğŸŒ ç„¡å¤‰æ› {space} å¤‰æ›"],shift:["Q W E R T Y U I O P","A S D F G H J K L +","Z X C V B N M < >","ğŸŒ ç„¡å¤‰æ› {space} å¤‰æ›"]},keyboardDisplay={"{space}":" ","{altLeft}":"Alt","{altRight}":"Alt","ğŸŒ":navigator.language.startsWith("ja")?"ğŸ‡¯ğŸ‡µ":"ğŸ‡ºğŸ‡¸"},simpleKeyboard=new SimpleKeyboard.default({layout:navigator.language.startsWith("ja")?layout109:layout104,display:keyboardDisplay,onInit:()=>{document.getElementById("keyboard").classList.add("d-none")},onKeyPress:e=>{switch(e){case"{space}":return typeEventKey(" ");case"ç„¡å¤‰æ›":return typeEventKey("NonConvert");case"å¤‰æ›":return typeEventKey("Convert");case"ğŸŒ":{simpleKeyboard.options.layout==layout109?(keyboardDisplay["ğŸŒ"]="ğŸ‡ºğŸ‡¸",simpleKeyboard.setOptions({layout:layout104,display:keyboardDisplay})):(keyboardDisplay["ğŸŒ"]="ğŸ‡¯ğŸ‡µ",simpleKeyboard.setOptions({layout:layout109,display:keyboardDisplay}));break}default:return typeEventKey(e)}}}),audioContext=new globalThis.AudioContext,audioBufferCache={};loadAudio("end","mp3/end.mp3"),loadAudio("keyboard","mp3/keyboard.mp3"),loadAudio("correct","mp3/correct.mp3"),loadAudio("incorrect","mp3/cat.mp3");let japaneseVoices=[];loadVoices(),loadConfig();function loadConfig(){localStorage.getItem("darkMode")==1&&document.documentElement.setAttribute("data-bs-theme","dark"),localStorage.getItem("bgm")!=1&&(document.getElementById("bgmOn").classList.add("d-none"),document.getElementById("bgmOff").classList.remove("d-none"))}function toggleDarkMode(){localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),document.documentElement.setAttribute("data-bs-theme","light")):(localStorage.setItem("darkMode",1),document.documentElement.setAttribute("data-bs-theme","dark"))}function toggleBGM(){localStorage.getItem("bgm")==1?(document.getElementById("bgmOn").classList.add("d-none"),document.getElementById("bgmOff").classList.remove("d-none"),localStorage.setItem("bgm",0),bgm.pause()):(document.getElementById("bgmOn").classList.remove("d-none"),document.getElementById("bgmOff").classList.add("d-none"),localStorage.setItem("bgm",1),bgm.play())}function toggleKeyboard(){const e=document.getElementById("virtualKeyboardOn"),t=document.getElementById("virtualKeyboardOff");e.classList.contains("d-none")?(e.classList.remove("d-none"),t.classList.add("d-none"),document.getElementById("keyboard").classList.remove("d-none")):(e.classList.add("d-none"),t.classList.remove("d-none"),document.getElementById("keyboard").classList.add("d-none"),document.getElementById("guideSwitch").checked=!1,guide=!1)}function toggleGuide(e){e.target.checked?guide=!0:guide=!1}async function playAudio(e,t){const s=await loadAudio(e,audioBufferCache[e]),n=audioContext.createBufferSource();if(n.buffer=s,t){const e=audioContext.createGain();e.gain.value=t,e.connect(audioContext.destination),n.connect(e),n.start()}else n.connect(audioContext.destination),n.start()}async function loadAudio(e,t){if(audioBufferCache[e])return audioBufferCache[e];const s=await fetch(t),o=await s.arrayBuffer(),n=await audioContext.decodeAudioData(o);return audioBufferCache[e]=n,n}function unlockAudio(){audioContext.resume()}function loadVoices(){const e=new Promise(e=>{let t=speechSynthesis.getVoices();if(t.length!==0)e(t);else{let n=!1;speechSynthesis.addEventListener("voiceschanged",()=>{n=!0,t=speechSynthesis.getVoices(),e(t)}),setTimeout(()=>{n||document.getElementById("noTTS").classList.remove("d-none")},1e3)}});e.then(e=>{japaneseVoices=e.filter(e=>e.lang=="ja-JP")})}function loopVoice(e,t){speechSynthesis.cancel();const n=new globalThis.SpeechSynthesisUtterance(e);n.voice=japaneseVoices[Math.floor(Math.random()*japaneseVoices.length)],n.lang="ja-JP";for(let e=0;e<t;e++)speechSynthesis.speak(n)}function loadProblems(){fetch("problems.csv").then(e=>e.text()).then(e=>{problems=e.trimEnd().split(`
`).map((e,t)=>{const[n,s]=e.split(",");return{id:t,kanji:n,yomi:s}}),problem=problems[12],problem.romaji=new i(problem.yomi)}).catch(e=>{console.error(e)})}function nextProblem(){playAudio("correct",.3),solveCount+=1,typable()}function removeGuide(e){e==" "&&(e="{space}");const t=simpleKeyboard.getButtonElement(e);if(t)t.classList.remove("guide"),simpleKeyboard.setOptions({layoutName:"default"});else{const e=simpleKeyboard.getButtonElement("{shift}");e&&e.classList.remove("guide")}}function showGuide(e){e==" "&&(e="{space}");const t=simpleKeyboard.getButtonElement(e);if(t)t.classList.add("guide");else{const e=simpleKeyboard.getButtonElement("{shift}");e&&e.classList.add("guide")}}function typeEvent(e){switch(e.code){case"Space":e.preventDefault();default:return typeEventKey(e.key)}}function typeEventKey(e){switch(e){case"NonConvert":{loopVoice(problem.kanji,1),japanese.textContent=`${problem.kanji} (${problem.yomi})`;const e="visible";japanese.style.visibility=e;const t=romaNode.children;t[1].style.visibility=e,t[2].style.visibility=e,downTime(5);return}case"Escape":startGame();return;case" ":if(!playing){startGame();return}}if(e.length==1){e=e.toLowerCase();const t=problem.romaji,n=problem.romaji.currentNode,s=t.input(e);if(s){playAudio("keyboard"),normalCount+=1;const s=t.remainedRomaji;romaNode.children[0].textContent+=e,romaNode.children[1].textContent=s[0],romaNode.children[2].textContent=s.slice(1);for(const e of n.children.keys())removeGuide(e);t.isEnd()?nextProblem():guide&&showGuide(s[0])}else playAudio("incorrect",.3),errorCount+=1}}function shuffle(e){for(let t=e.length;1<t;t--){const n=Math.floor(Math.random()*t);[e[n],e[t-1]]=[e[t-1],e[n]]}return e}function startGame(){clearInterval(typeTimer),initTime(),countdown(),shuffle(problems),countPanel.classList.remove("d-none"),scorePanel.classList.add("d-none")}function paintPrefecture(e){const t=document.getElementById("map").contentDocument;t.querySelectorAll(".main").forEach(t=>{for(;!t.dataset.code;)t=t.parentNode;const n=parseInt(t.dataset.code)-1;n==e?t.setAttribute("fill","black"):t.setAttribute("fill","#eee")})}function typable(){if(solveCount>=problems.length)speechSynthesis.cancel(),clearInterval(typeTimer),bgm.pause(),playAudio("end"),scoring();else{const s=problem;problem=problems[solveCount],paintPrefecture(problem.id),japanese.textContent=`${problem.kanji} (${problem.yomi})`;const t=new i(problem.yomi);problem.romaji=t;const e=romaNode.children;e[0].textContent=t.inputedRomaji,e[1].textContent=t.remainedRomaji[0],e[2].textContent=t.remainedRomaji.slice(1),mode.textContent=="EASY"&&loopVoice(problem.kanji,1);const n=mode.textContent=="EASY"?"visible":"hidden";if(e[1].style.visibility=n,e[2].style.visibility=n,japanese.style.visibility=n,guide){if(s){const e=s.romaji.currentNode;if(e)for(const t of e.children.keys())removeGuide(t)}const e=problem.romaji.currentNode.children.keys().next().value;showGuide(e)}}}function countdown(){if(countdowning)return;countdowning=!0,normalCount=errorCount=solveCount=0,document.getElementById("guideSwitch").disabled=!0,document.getElementById("virtualKeyboard").disabled=!0,gamePanel.classList.add("d-none"),infoPanel.classList.add("d-none"),countPanel.classList.remove("d-none"),counter.textContent=3;const e=setInterval(()=>{const t=document.getElementById("counter"),n=["skyblue","greenyellow","violet","tomato"];if(parseInt(t.textContent)>1){const e=parseInt(t.textContent)-1;t.style.backgroundColor=n[e],t.textContent=e}else countdowning=!1,playing=!0,clearInterval(e),document.getElementById("guideSwitch").disabled=!1,document.getElementById("virtualKeyboard").disabled=!1,gamePanel.classList.remove("d-none"),countPanel.classList.add("d-none"),infoPanel.classList.remove("d-none"),scorePanel.classList.add("d-none"),globalThis.scrollTo({top:document.getElementById("typePanel").getBoundingClientRect().top,behavior:"auto"}),typable(),startTypeTimer(),localStorage.getItem("bgm")==1&&bgm.play()},1e3)}function startTypeTimer(){const e=document.getElementById("time");typeTimer=setInterval(()=>{const t=parseInt(e.textContent);t>0?e.textContent=t-1:(clearInterval(typeTimer),bgm.pause(),playAudio("end"),scoring())},1e3)}function downTime(e){const t=document.getElementById("time"),s=parseInt(t.textContent),n=s-e;n<0?t.textContent=0:t.textContent=n}function initTime(){document.getElementById("time").textContent=gameTime}function scoring(){playing=!1,infoPanel.classList.remove("d-none"),gamePanel.classList.add("d-none"),countPanel.classList.add("d-none"),scorePanel.classList.remove("d-none");let e=parseInt(document.getElementById("time").textContent);e<300&&(e=gameTime-e);const t=(normalCount/e).toFixed(2);document.getElementById("solveCount").textContent=solveCount,document.getElementById("totalType").textContent=normalCount+errorCount,document.getElementById("typeSpeed").textContent=t,document.getElementById("errorType").textContent=errorCount,document.getElementById("twitter").href="https://twitter.com/intent/tweet?text=éƒ½é“åºœçœŒã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚’ãƒ—ãƒ¬ã‚¤ã—ãŸã‚ˆ! (é€Ÿåº¦: "+t+"å›/ç§’) &url=https%3a%2f%2fmarmooo.github.com/prefectures-typing/%2f&hashtags=éƒ½é“åºœçœŒã‚¿ã‚¤ãƒ”ãƒ³ã‚°"}function changeMode(e){e.target.textContent=="EASY"?e.target.textContent="HARD":e.target.textContent="EASY"}paintPrefecture(13),loadProblems(),document.getElementById("toggleDarkMode").onclick=toggleDarkMode,document.getElementById("toggleBGM").onclick=toggleBGM,document.getElementById("virtualKeyboard").onclick=toggleKeyboard,document.getElementById("mode").onclick=changeMode,document.getElementById("guideSwitch").onchange=toggleGuide,startButton.addEventListener("click",startGame),document.addEventListener("keydown",typeEvent),document.addEventListener("click",unlockAudio,{once:!0,useCapture:!0})